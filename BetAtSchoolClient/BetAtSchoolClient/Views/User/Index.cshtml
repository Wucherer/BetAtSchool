@using BetAtSchoolClient.Controllers;
@using BetAtSchoolClient.Models;
@{
    ViewBag.Title = "Index";
    Layout = null;
    ControllerHelper ch = new ControllerHelper();
    string currentPlayer = HttpContext.Current.Session["currentPlayer"] as string;
    UserGuide guide = HttpContext.Current.Session["currentGuide"] as UserGuide;
    HttpContext.Current.Session.Add("currentPlayer", currentPlayer);
}
<title>Manage User</title>
<script>
    function btnStartClick(e)
    {
        var msg = $('#msgLogin');
        var username = $('#txtNickname');
        var cb = $("#stations").data("kendoComboBox");
        var text = cb.value();
       
        if (text != null)
        {
            $.ajax(
                {
                    type: 'GET',
                    url: '@Url.Action("setStation", "User")',
                    data: { name: text, player: username.val() },
                    success: function (result) {
                        $("#body").html(result);
                    }
                });
        } else {

            msg.text("Please select Station !");
            if (username.val() == "")
            {
                msg.text("Please select Station and create User !");
            }
            
        }


    }
    function CbxCh(e) {
        $.ajax(
               {
                   type: 'GET',
                   url: '@Url.Action("getAllStations", "User")',
                   success: function (result) {
                       var cb = $("#stations").data("kendoComboBox");
                       cb.setDataSource(result);
                   }
               });
    }


</script>
<div id="Login-content" class="demo-section k-content">
    <p id="currentGuide" class="demo-section k-content">currently logged in: @guide.Username</p>
    @if (currentPlayer == null)
    {
        <p id="currentPlayer" class="demo-section k-content">currently playing: @currentPlayer</p>
    }

    @if(currentPlayer == null)
    {
        <p class="title">Register Guest</p>
    }
    else
    {
        <p class="title">Select Station</p>
    }
    @Html.Kendo().PanelBar().Name("panelRegister").Items(items =>
{
if (currentPlayer == null)
{
    items.Add().Text("Nickname of Guest").Expanded(true).Content(@<div>@Html.Kendo().TextBox().Name("txtNickname") <label id="msgUsername"></label></div>);
}
else {
    items.Add().Text("currently playing: " + currentPlayer).Expanded(false);
}

items.Add().Text("Station").Expanded(true).Content(@<div>
        @(Html.Kendo().ComboBox()
          .Name("stations")
          .Placeholder("Select station")
          .HtmlAttributes(new { style = "width:100%;" })
          .Filter("contains")
          .AutoBind(false)
          .MinLength(3)
          .DataSource(source =>
          {
              source.Read(read =>
              {
                  read.Action("getAllStations", "User");
              });

          }).Events(e=>e.Change("CbxCh"))
                                                                )

    </div>);
    })
    
    @Html.Kendo().Button().Name("btnStartQuiz").Content("Start Quiz !").Events(e => e.Click("btnStartClick")) <label id="msgLogin"></label>
</div>


<style>
  .demo-section {
        padding: 0;

        width: 40%;
        margin-top:5%;
        margin-left:30%;
    }

    #btnStartQuiz {

        margin-top:10px;
    }

    #Login-content .title {
        font-size: 16px;
        color: #fff;
        background-color: #1e88e5;
        padding: 20px 30px;
        margin: 0;
    }

    #fieldlist {
        margin: 0 0 -1.5em;
        padding: 30px;
    }

        #fieldlist li {
            list-style: none;
            padding-bottom: 1.5em;
        }

        #fieldlist label {
            display: block;
            padding-bottom: .6em;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 12px;
            color: #444;
        }


</style>
